import{b as U,u as I,a as q,d as k,f as L,g as a,k as l,t as r,m as B,w as E,F as p,h as m,p as i,x as g,y as T,z as R,l as b,i as f,A as _,v as x,B as $,C as j,D as F,j as V,r as P,o,n as z,E as A,s as M,G as C,H as G}from"./index-jbwhbzbo.js";const H={class:"container flex flex-col gap-3 p-4"},Q={class:"flex flex-grow justify-between"},J={class:"text-3xl font-bold mt-3"},K={class:"flex flex-col lg:flex-row gap-3"},O={class:"lg:w-96 w flex flex-col gap-3"},W=["src"],X={class:"bg-slate-700 p-3 rounded-md"},Y={class:"flex flex-col w-full"},Z={action:"#",class:"flex flex-col gap-3"},ee={class:"flex flex-col gap-3"},te=["for"],le=["type","placeholder","id","onUpdate:modelValue"],se=["id","onUpdate:modelValue"],ae={selected:"",value:""},oe={class:"flex flex-col gap-3 bg-slate-700 p-3 rounded-xl"},ne=l("label",{for:"currency"},"Currency",-1),ce={class:"flex gap-3"},re=["value"],de=["src"],ue=["for"],ie={key:0,class:"flex flex-col relative w-4/12 p-3 rounded-xl items-center text-center bg-slate-600"},ge=l("label",{class:"text-lg"},"No items found",-1),pe=[ge],me={class:"flex flex-col gap-3"},_e=l("label",{for:"item"},"Item",-1),ve={key:0,class:"flex gap-3"},fe=["value","onUpdate:modelValue"],xe=["src"],ye=["for"],he=["for"],be={key:1,class:"bg-slate-700 p-3 rounded-xl"},we={class:"flex gap-3"},ke={class:"flex flex-col grow gap-3"},Re=l("label",{for:"phoneNumber"},"Phone number",-1),Ve={class:"flex gap-3 w-full bg-slate-700 p-3 rounded-xl"},Me={class:"flex flex-col grow gap-3"},Ce=l("label",{for:"qty"},"Quantity",-1),Ne=["selected","value"],Ue={__name:"ItemView",setup(De){const v=U(),y=I(),N=q(),t=k({game:{},currency:{},item:{},loginMethod:{},qty:1,user:""}),D=async()=>{if(!t.value.currency||!t.value.item||!t.value.loginMethod){alert("Please select currency and item");return}const n={...t.value},c=f(x,"cart"),d=_(x,"game",y.params.id),e=_(d,"products",t.value.currency.id),s=_(e,"items",t.value.item.id);n.item=s,n.game=d,n.currency=e,n.user=v.user.uid,n.timestamp=G();try{const u=await $(c,n);console.log("Post added with ID: ",u.id),await j(s,{cartId:u.id},{merge:!0}),N.push("/cart")}catch(u){console.error("Error adding post: ",u)}},h=k({items:[]}),S=async()=>{try{const n=_(x,"game",y.params.id),c=await F(n);t.value.game=c.data(),t.value.loginMethod=t.value.game.method.reduce((s,u)=>(s[u.name]="",s),{});const d=f(n,"products"),e=await V(d);t.value.game.products=e.docs.map(s=>s.data()),t.value.game.products.length>0&&(t.value.currency=t.value.game.products[0],w())}catch{}},w=async()=>{try{const n=f(x,"game",y.params.id,"products"),c=_(n,t.value.currency.id),d=f(c,"items"),e=await V(d);h.value.items=e.docs.map(s=>s.data())}catch{}};return L(()=>{S()}),(n,c)=>{const d=P("RouterLink");return o(),a("div",H,[l("div",Q,[l("h1",J,r(t.value.game.name),1),B(d,{to:"/products",class:"bg-slate-700 p-3 rounded-xl"},{default:E(()=>[z("Back")]),_:1})]),l("div",K,[l("div",O,[l("img",{src:t.value.game.image,alt:""},null,8,W),l("div",null,[l("p",X,r(t.value.game.desc),1)])]),l("div",Y,[l("form",Z,[t.value.game.method?(o(!0),a(p,{key:0},m(t.value.game.method,e=>(o(),a("div",ee,[l("label",{for:e.name},r(e.name),9,te),e.type!=="select"?g((o(),a("input",{key:0,type:e.type,placeholder:`Enter your ${e.name}`,class:"bg-slate-700 p-3 rounded-xl text-lg",id:e.name,"onUpdate:modelValue":s=>t.value.loginMethod[e.name]=s},null,8,le)),[[A,t.value.loginMethod[e.name]]]):i("",!0),e.type==="select"?g((o(),a("select",{key:1,class:"bg-slate-700 p-3 rounded-xl text-lg",id:e.name,"onUpdate:modelValue":s=>t.value.loginMethod[e.name]=s},[l("option",ae,"Select "+r(e.name),1),(o(!0),a(p,null,m(e.options,s=>(o(),a("option",{key:s},r(s),1))),128))],8,se)),[[R,t.value.loginMethod[e.name]]]):i("",!0)]))),256)):i("",!0),l("div",oe,[ne,l("div",ce,[(o(!0),a(p,null,m(t.value.game.products,e=>(o(),a("div",{key:e.id,class:M([t.value.currency.id==e.id?"bg-blue-500 ":"bg-slate-600","flex flex-col gap-2 relative w-4/12 p-3 rounded-xl justify-center items-center text-center"])},[g(l("input",{onChange:w,value:e,"onUpdate:modelValue":c[0]||(c[0]=s=>t.value.currency=s),class:"absolute opacity-0 cursor-pointer w-full h-full top-0 left-0",type:"radio",name:"currency",id:"currency"},null,40,re),[[C,t.value.currency]]),l("img",{src:e.image,alt:""},null,8,de),l("label",{class:"text-lg",for:"category_"+e},r(e.name),9,ue)],2))),128)),t.value.game.products.length==0?(o(),a("div",ie,pe)):i("",!0)])]),l("div",me,[_e,h.value.items.length>0?(o(),a("div",ve,[(o(!0),a(p,null,m(h.value.items,e=>(o(),a("div",{key:e.id,class:M([t.value.item.id==e.id?"bg-blue-500 ":"bg-slate-600","flex flex-col relative w-4/12 p-3 rounded-xl items-center text-center"])},[g(l("input",{value:e,"onUpdate:modelValue":s=>t.value.item=s,class:"absolute opacity-0 cursor-pointer w-full h-full top-0 left-0",type:"radio",name:"currency",id:"currency"},null,8,fe),[[C,t.value.item]]),l("img",{src:t.value.currency.image,alt:""},null,8,xe),l("label",{class:"text-lg",for:"category_"+e.id},r(e.name),9,ye),l("label",{class:"text-lg",for:"category_"+e.id},"Rp "+r(e.price.toLocaleString()),9,he)],2))),128))])):(o(),a("div",be,"No item added"))]),l("div",we,[l("div",ke,[Re,l("div",Ve,[g(l("input",{type:"text",class:"bg-slate-100 p-3 flex grow text-black rounded-lg text-lg",id:"phoneNumber","onUpdate:modelValue":c[1]||(c[1]=e=>t.value.phoneNumber=e)},null,512),[[T,t.value.phoneNumber]])])]),l("div",Me,[Ce,g(l("select",{name:"qty","onUpdate:modelValue":c[2]||(c[2]=e=>t.value.qty=e),class:"bg-slate-700 p-6 text-lg rounded-xl",id:"qty"},[(o(),a(p,null,m(5,e=>l("option",{selected:t.value.qty==e?"selected":"",value:e,key:e},r(e),9,Ne)),64))],512),[[R,t.value.qty]])])]),l("div",null,[b(v).isLoggedIn?(o(),a("button",{key:0,type:"button",onClick:D,class:"bg-slate-700 text-xl p-3 rounded-xl"},"Add to cart")):i("",!0),b(v).isLoggedIn?i("",!0):(o(),a("button",{key:1,type:"button",onClick:c[3]||(c[3]=e=>b(v).openModal("login")),class:"bg-slate-700 text-xl p-3 rounded-xl"},"Log In First"))])])])])])}}};export{Ue as default};
